------

# 基于贝叶斯定理的手写数字识别实验报告

## 1. 引言

贝叶斯定理是概率论中的一个重要定理，它提供了一种在已知一些条件下，计算某事件概率的方法。在手写数字识别中，贝叶斯定理可以帮助我们计算给定观测数据（图像特征）时，一个数字属于某个类别的概率。

## 2. 贝叶斯定理

贝叶斯定理的公式如下：

$$P(A|B) = \frac{P(B|A) \cdot P(A)}{P(B)}$$

其中：

- *P*(*A*∣*B*) 是后验概率，即在事件B发生的条件下，事件A发生的概率。
- *P*(*B*∣*A*) 是似然度，即在事件A发生的条件下，事件B发生的概率。
- *P*(*A*) 是事件A的先验概率，即在没有其他信息的情况下，事件A发生的概率。
- *P*(*B*) 是事件B的边缘概率，即在没有其他信息的情况下，事件B发生的概率。

在手写数字识别中，我们可以将上述公式应用于分类问题。假设 𝐴*A* 代表数字图像属于某个类别（例如，类别1），𝐵*B* 代表观测到的图像特征。我们的目标是计算 𝑃(𝐴∣𝐵)*P*(*A*∣*B*)，即在给定图像特征的条件下，图像属于类别 𝐴*A* 的概率。

## 3. 实验方法

### 3.1 数据准备

使用MNIST数据集，该数据集包含了0到9的手写数字图像。根据idx的结构设计了`read`库，用来读取相关的图片信息。

### 3.2 数据预处理

对图像数据进行了分析处理，将灰度图进行二值化处理，以减少数据的复杂性，同时保留关键特征。这里基于数理统计得到最佳阈值50.

<img src="E:\workpace\作业中心\朴素贝叶斯分类minist\README.assets\屏幕截图 2024-06-19 174028.png" style="zoom: 50%;" />

### 3.3 模型训练

在训练函数 `Train` 中，首先初始化先验概率和条件概率。接着，遍历训练集，计算每个类别的先验概率以及给定类别下每个特征的条件概率。

### 3.4 模型评估

在训练完成后，使用测试集评估模型的性能。通过计算准确率、召回率和 F1 分数等指标，来衡量模型在手写数字识别任务上的表现。最终的结果如下：

```
Start read data
read data cost  0.02672719955444336  second 

Start training
training cost  12.656096696853638  second 

Start predicting
predicting cost  4.508090496063232  second 

The accruacy socre is  0.7799999713897705
```

## 4. 讨论

基于贝叶斯定理的手写数字识别实验验证了贝叶斯定理在模式识别中的有效性。通过计算先验概率和条件概率，我们能够对手写数字进行准确的分类。实验结果表明，基于贝叶斯定理的方法在手写数字识别任务上具有良好的性能。

## 5. 结论

本实验成功构建了一个基于贝叶斯定理的手写数字识别系统，并在MNIST数据集上进行了评估。实验结果表明，基于贝叶斯定理的方法在手写数字识别任务上具有良好的性能。

项目开源在https://github.com/xuanlove29/Bayesian中。
